    #OS    $OS = (Get-WmiObject -Class Win32_OperatingSystem).version    #Generate form    function GenerateForm {    [reflection.assembly]::loadwithpartialname("System.Windows.Forms") | Out-Null    [reflection.assembly]::loadwithpartialname("System.Drawing") | Out-Null    $form1 = New-Object System.Windows.Forms.Form    $button1 = New-Object System.Windows.Forms.Button    $listBox1 = New-Object System.Windows.Forms.ListBox    $brm = New-Object System.Windows.Forms.CheckBox    $mozillaFirefox = New-Object System.Windows.Forms.CheckBox    $googleChrome = New-Object System.Windows.Forms.CheckBox    $kaspersky = New-Object System.Windows.Forms.CheckBox    $vlc = New-Object System.Windows.Forms.CheckBox    $7zip = New-Object System.Windows.Forms.CheckBox    $libreOffice = New-Object System.Windows.Forms.CheckBox    $teamViewer = New-Object System.Windows.Forms.CheckBox    $InitialFormWindowState = New-Object System.Windows.Forms.FormWindowState    $b1= $false    $b2= $false    $b3= $false    #----------------------------------------------    #Generated Event Script Blocks    #----------------------------------------------    $handler_button1_Click=     {    	$env:ComputerName | Out-File "C:/Windows/BRM Computers/$log.log" -Append    	$date | Out-File "C:/Windows/BRM Computers/$log.log" -Append    	$OS | Out-File "C:/Windows/BRM Computers/$log.log" -Append        $listBox1.Items.Clear();            if ($brm.Checked)	{    		$listBox1.Items.Add("BRM OEM is checked."  )    		}        if ($mozillaFirefox.Checked)	{    		$listBox1.Items.Add("Mozilla Firefox is checked."  )    		}        if ($googleChrome.Checked)	{    		$listBox1.Items.Add("Google Chrome is checked."  )    		}    	if ($kaspersky.Checked)	{    		$listBox1.Items.Add("Kaspersky Internet Security 2017 is checked."  )    		}    	if ($vlc.Checked)	{    		$listBox1.Items.Add("VLC Media Player is checked."  )    		}    	if ($7zip.Checked)	{    		$listBox1.Items.Add("7zip is checked."  )    		}    	if ($libreOffice.Checked)	{    		$listBox1.Items.Add("LibreOffice is checked."  )    		}    	if ($teamViewer.Checked)	{    		$listBox1.Items.Add("TeamViewer is checked."  )    		}        if ( !$brm.Checked -and !$mozillaFirefox.Checked -and !$googleChrome.Checked ) {    		$listBox1.Items.Add("No programs are selected, please select some programs to install.")    		}     	$listBox1.Items.Add("Installing .NET4.5 ...")    	$listBox1.Items.Add("Finished installing .NET4.5 ...")    	if ($brm.Checked)	{    	    $listBox1.Items.Add("Installing BRM OEM information ...")    		$listBox1.Items.Add("Finished installing BRM OEM information.")    		}    	if ($mozillaFirefox.Checked)	{    		$listBox1.Items.Add("Installing Mozilla Firefox ...")    		$listBox1.Items.Add("Finished installing Firefox."  )    		}    	if ($googleChrome.Checked)	{    		$listBox1.Items.Add("Starting installing Google Chrome ...")    		$listBox1.Items.Add("Finished installing Google Chrome.")    		}    	if ($kaspersky.Checked)	{    		$listBox1.Items.Add("Starting installing Kaspersky Internet Security 2017 ...")    		$listBox1.Items.Add("Finished installing Kaspersky Internet Security 2017.")    		}    	if ($vlc.Checked)	{    		$listBox1.Items.Add("Starting installing VLC Media Player ...")    		$listBox1.Items.Add("Finished installing VLC Media Player.")    		}    	if ($7zip.Checked)	{    		$listBox1.Items.Add("Starting installing 7zip ...")    		$listBox1.Items.Add("Finished installing 7zip.")    		}    	if ($libreOffice.Checked)	{    		$listBox1.Items.Add("Starting installing LibreOffice ...")    		$listBox1.Items.Add("Finished installing LibreOffice.")    		}    	if ($teamViewer.Checked)	{    		$listBox1.Items.Add("Starting installing TeamViewer ...")    		$listBox1.Items.Add("Finished installing TeamViewer.")    		}    	if ($OS -like '*6.1*')	{    		$listBox1.Items.Add("This computer is running Windows 7.")    		$listBox1.Items.Add("The install has finished!")    		}    	if ($OS -like '*6.2*')	{    		$listBox1.Items.Add("This computer is running Windows 8.")    		$listBox1.Items.Add("Setting taskbar icons ...")    		$listBox1.Items.Add("The install has finished!")    		}    	if ($OS -like '*6.3*')	{    		$listBox1.Items.Add("This computer is running Windows 8.1.")    		$listBox1.Items.Add("Setting taskbar icons ...")    		$listBox1.Items.Add("The install has finished!")    		}    	if ($OS -like '*10.0*')	{    		$listBox1.Items.Add("This computer is running Windows 10.")    		$listBox1.Items.Add("The install has finished!")    		}    }    $OnLoadForm_StateCorrection=    {#Correct the initial state of the form to prevent the .Net maximized form issue        $form1.WindowState = $InitialFormWindowState    }    $form1.Text = "BRM Installer PS Chandlers Ford v1.0.0"    $form1.Name = "form1"    $form1.DataBindings.DefaultDataSourceUpdateMode = 0    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 650    $System_Drawing_Size.Height = 550    $form1.ClientSize = $System_Drawing_Size    $form1.Icon = "C:\Windows\BRM Computers\OEM.ico"    #Install button    $button1.TabIndex = 4    $button1.Name = "button1"    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 75    $System_Drawing_Size.Height = 23    $button1.Size = $System_Drawing_Size    $button1.UseVisualStyleBackColor = $True    $button1.Text = "Install"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 106    $System_Drawing_Point.Y = 514    $button1.Location = $System_Drawing_Point    $button1.DataBindings.DefaultDataSourceUpdateMode = 0    $button1.add_Click($handler_button1_Click)    $form1.Controls.Add($button1)    #Text box    $listBox1.FormattingEnabled = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 350    $System_Drawing_Size.Height = 524    $listBox1.Size = $System_Drawing_Size    $listBox1.DataBindings.DefaultDataSourceUpdateMode = 0    $listBox1.Name = "listBox1"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 287    $System_Drawing_Point.Y = 13    $listBox1.Location = $System_Drawing_Point    $listBox1.TabIndex = 3    $form1.Controls.Add($listBox1)    #BRM OEM    $brm.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 200    $System_Drawing_Size.Height = 24    $brm.Size = $System_Drawing_Size    $brm.TabIndex = 0    $brm.Text = "BRM OEM"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 13    $brm.Location = $System_Drawing_Point    $brm.DataBindings.DefaultDataSourceUpdateMode = 0    $brm.Name = "brm"    $brm.Checked = 1    $form1.Controls.Add($brm)    $brm.ForeColor = "#20409a"    $brm.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #Mozilla Firefox    $mozillaFirefox.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 200    $System_Drawing_Size.Height = 24    $mozillaFirefox.Size = $System_Drawing_Size    $mozillaFirefox.TabIndex = 1    $mozillaFirefox.Text = "Mozilla Firefox"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 168    $mozillaFirefox.Location = $System_Drawing_Point    $mozillaFirefox.DataBindings.DefaultDataSourceUpdateMode = 0    $mozillaFirefox.Name = "mozillaFirefox"    $mozillaFirefox.Checked = 1    $form1.Controls.Add($mozillaFirefox)    $mozillaFirefox.ForeColor = "#20409a"    $mozillaFirefox.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #Google Chrome    $googleChrome.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 200    $System_Drawing_Size.Height = 24    $googleChrome.Size = $System_Drawing_Size    $googleChrome.TabIndex = 2    $googleChrome.Text = "Google Chrome"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 75    $googleChrome.Location = $System_Drawing_Point    $googleChrome.DataBindings.DefaultDataSourceUpdateMode = 0    $googleChrome.Name = "googleChrome"    $googleChrome.Checked = 1    $form1.Controls.Add($googleChrome)    $googleChrome.ForeColor = "#20409a"    $googleChrome.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #Kaspersky Internet Security 2017    $kaspersky.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 250    $System_Drawing_Size.Height = 24    $kaspersky.Size = $System_Drawing_Size    $kaspersky.TabIndex = 3    $kaspersky.Text = "Kaspersky Internet Security 2017"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 106    $kaspersky.Location = $System_Drawing_Point    $kaspersky.DataBindings.DefaultDataSourceUpdateMode = 0    $kaspersky.Name = "kaspersky"    $kaspersky.Checked = 1    $form1.Controls.Add($kaspersky)    $kaspersky.ForeColor = "#20409a"    $kaspersky.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #VLC Media Player    $vlc.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 200    $System_Drawing_Size.Height = 24    $vlc.Size = $System_Drawing_Size    $vlc.TabIndex = 4    $vlc.Text = "VLC Media Player"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 230    $vlc.Location = $System_Drawing_Point    $vlc.DataBindings.DefaultDataSourceUpdateMode = 0    $vlc.Name = "vlc"    $vlc.Checked = 1    $form1.Controls.Add($vlc)    $vlc.ForeColor = "#20409a"    $vlc.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #7zip    $7zip.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 200    $System_Drawing_Size.Height = 24    $7zip.Size = $System_Drawing_Size    $7zip.TabIndex = 5    $7zip.Text = "7zip"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 44    $7zip.Location = $System_Drawing_Point    $7zip.DataBindings.DefaultDataSourceUpdateMode = 0    $7zip.Name = "7zip"    $7zip.Checked = 1    $form1.Controls.Add($7zip)    $7zip.ForeColor = "#20409a"    $7zip.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #LibreOffice    $libreOffice.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 200    $System_Drawing_Size.Height = 24    $libreOffice.Size = $System_Drawing_Size    $libreOffice.TabIndex = 6    $libreOffice.Text = "LibreOffice"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 137    $libreOffice.Location = $System_Drawing_Point    $libreOffice.DataBindings.DefaultDataSourceUpdateMode = 0    $libreOffice.Name = "libreOffice"    $libreOffice.Checked = 1    $form1.Controls.Add($libreOffice)    $libreOffice.ForeColor = "#20409a"    $libreOffice.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #TeamViewer    $teamViewer.UseVisualStyleBackColor = $True    $System_Drawing_Size = New-Object System.Drawing.Size    $System_Drawing_Size.Width = 200    $System_Drawing_Size.Height = 24    $teamViewer.Size = $System_Drawing_Size    $teamViewer.TabIndex = 7    $teamViewer.Text = "TeamViewer"    $System_Drawing_Point = New-Object System.Drawing.Point    $System_Drawing_Point.X = 27    $System_Drawing_Point.Y = 199    $teamViewer.Location = $System_Drawing_Point    $teamViewer.DataBindings.DefaultDataSourceUpdateMode = 0    $teamViewer.Name = "teamViewer"    $teamViewer.Checked = 1    $form1.Controls.Add($teamViewer)    $teamViewer.ForeColor = "#20409a"    $teamViewer.Font = New-Object System.Drawing.Font("Calibri",10,[System.Drawing.FontStyle]::Bold)    #Save the initial state of the form    $InitialFormWindowState = $form1.WindowState    #Init the OnLoad event to correct the initial state of the form    $form1.add_Load($OnLoadForm_StateCorrection)    #Show the Form    $form1.ShowDialog() | Out-Null    }    #Call the Function    GenerateForm